@echo off
REM ============================================================================
REM SHOW_FILE_METADATA.BAT
REM 
REM Wrapper Windows pour show_file_metadata.py
REM Facilite l'affichage des mÃ©tadonnÃ©es d'un fichier
REM
REM Usage:
REM   SHOW_FILE_METADATA.BAT "path\to\file.mp4"
REM   SHOW_FILE_METADATA.BAT "path\to\file.mp4" --json
REM   SHOW_FILE_METADATA.BAT "path\to\file.mp4" --save
REM   
REM Ou glisser-dÃ©poser un fichier sur ce script
REM ============================================================================

setlocal EnableDelayedExpansion

REM Obtenir le rÃ©pertoire du script
set SCRIPT_DIR=%~dp0
set SCRIPT_DIR=%SCRIPT_DIR:~0,-1%

REM Chemin vers le script Python
set PYTHON_SCRIPT=%SCRIPT_DIR%\debug\show_file_metadata.py

REM VÃ©rifier si Python est disponible
python --version >nul 2>&1
if %ERRORLEVEL% NEQ 0 (
    echo.
    echo âŒ Erreur: Python n'est pas installÃ© ou pas dans le PATH
    echo.
    echo Veuillez installer Python 3.8+ depuis: https://www.python.org/
    echo.
    pause
    exit /b 1
)

REM VÃ©rifier si le script Python existe
if not exist "%PYTHON_SCRIPT%" (
    echo.
    echo âŒ Erreur: Script Python introuvable: %PYTHON_SCRIPT%
    echo.
    pause
    exit /b 1
)

REM VÃ©rifier si un fichier a Ã©tÃ© fourni
if "%~1"=="" (
    echo.
    echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    echo â•‘                   SHOW FILE METADATA - Afficheur de MÃ©tadonnÃ©es        â•‘
    echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    echo.
    echo Usage:
    echo   %~nx0 "path\to\file.mp4"
    echo   %~nx0 "path\to\file.mp4" --json
    echo   %~nx0 "path\to\file.mp4" --save
    echo.
    echo Ou glisser-dÃ©poser un fichier sur ce script
    echo.
    echo Options:
    echo   --json              Sortie en format JSON
    echo   --save              Sauvegarder dans un fichier .metadata.txt
    echo   --footage-raw PATH  Chemin vers Footage_raw pour dÃ©tection de source
    echo   --tz TIMEZONE       Timezone pour conversion drone
    echo.
    echo Exemples:
    echo   %~nx0 "F:\Project\video.mp4"
    echo   %~nx0 "F:\Project\video.mp4" --json
    echo   %~nx0 "F:\Project\drone\DJI_0001.mp4" --footage-raw "F:\Project\Footage_raw"
    echo.
    pause
    exit /b 1
)

REM Construire la commande
set FILE_PATH=%~1
set EXTRA_ARGS=%2 %3 %4 %5 %6 %7 %8 %9

echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                   SHOW FILE METADATA - Analyse en cours                â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo ğŸ“ Fichier: %~nx1
echo ğŸ“‚ Chemin:  %FILE_PATH%
echo.

REM ExÃ©cuter le script Python
python "%PYTHON_SCRIPT%" "%FILE_PATH%" %EXTRA_ARGS%

set EXIT_CODE=%ERRORLEVEL%

echo.
if %EXIT_CODE% EQU 0 (
    echo âœ… Analyse terminÃ©e avec succÃ¨s
) else (
    echo âŒ Erreur lors de l'analyse (code: %EXIT_CODE%^)
)
echo.
pause

exit /b %EXIT_CODE%
